/**	
 *	@author		HitkoDev http://hitko.eu/videobox
 *	@copyright	Copyright (C) 2015 HitkoDev All Rights Reserved.
 *	@license	http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */

!function(i){function e(e){i(C).html(r.closeText),i(c).css({top:e?-(i(v).innerHeight()/2-e.y):0,left:e?-(i(v).innerWidth()/2-e.x):0,padding:r.padding,"max-width":e?e.w+2*r.padding:""})}function t(e){return e>=0&&(l=e,a=s[e][0],d(),i(h).html(s[l][1]||""),n(),x=!0,i([v,b,overlay]).toggleClass("visible",!0),i(v).toggleClass("animating",!0),setTimeout(function(){i(c).css({top:0,left:0,"max-width":parseInt(s[l][2]||r.videoWidth)+2*r.padding})},10)),!1}function n(){var e=parseInt(s[l][2]||r.videoWidth),t=parseInt(s[l][3]||r.videoHeight);i(v).css({top:w.scrollTop(),left:w.scrollLeft()}),e+2*r.padding>i(v).innerWidth()&&(e=i(v).innerWidth()-2*r.padding),t=t*e/(s[l][2]||r.videoWidth),t+2*r.padding>i(v).innerHeight()&&(t=i(v).innerHeight()-2*r.padding);var n=100*t/e;i(f).css("padding-bottom",n+"%")}function o(){x&&""==i(g).attr("src")&&(i(g).show(),g.src=a,i(v).toggleClass("animating",!1))}function d(){x=!1,g.src="",i(g).hide()}var s,a,l,r,v,c,p,f,g,b,u,h,m,C,w=i(window),x=!1,T={videoWidth:720,videoHeight:405,closeText:"Close",padding:30};i.videobox=function(n,o,d,a){return r=i.extend(T,d),e(a),s=n,t(o),!1},i.vbClose=function(){return d(),i([v,b,overlay]).toggleClass("visible",!1),i(v).toggleClass("animating",!1),i(v).css({top:0,left:0}),l>=0&&(l=-1),!1},i.fn.videobox=function(e,t){t=t||function(i){return[i.getAttribute("href"),i.getAttribute("title"),i.getAttribute("data-videowidth"),i.getAttribute("data-videoheight")]};var n=this;return n.unbind("click").click(function(o){for(var d=this,s=0,a=n.slice(),l=i(this).find(this.getAttribute("data-target"))[0]||this,r=0;r<a.length;r++)a[r]==d&&(s=r),a[r]=t(a[r],r);return i.videobox(a,s,e,{x:i(l).offset().left-w.scrollLeft()+i(l).innerWidth()/2,y:i(l).offset().top-w.scrollTop()+i(l).innerHeight()/2,w:i(l).innerWidth()})})},i(function(){i("body").append(i([overlay=i('<div id="vbOverlay" />').click(i.vbClose)[0],v=i('<div id="vbWrap" />')[0]])),c=i('<div id="vbCenter" />').appendTo(v)[0],p=i('<div id="vbContent" />').appendTo(c).append([f=i('<div id="vbResponsive" />')[0],b=i('<div id="vbBottomContainer" />').on("webkitTransitionEnd transitionend mozTransitionEnd oTransitionEnd",o)[0]])[0],g=i('<iframe id="vbVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(f)[0],u=i('<div id="vbBottom" />').appendTo(b).append([m=i('<a id="vbCloseLink" href="#" ><span id="vbCloseText">'+T.closeText+'</span><i class="vb-icon-close"></i></a>').click(i.vbClose)[0],h=i('<span id="vbCaption" />')[0]])[0],C=i(u).find("#vbCloseText")[0]}),w.on("resize",function(){l>=0&&n()}),i("a[rel^='videobox']").videobox({})}(jQuery);