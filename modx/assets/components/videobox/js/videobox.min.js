/**	
 *	@author		HitkoDev http://hitko.eu/videobox
 *	@copyright	Copyright (C) 2015 HitkoDev All Rights Reserved.
 *	@license	http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
 *
 *	This program is free software: you can redistribute it and/or modify
 *	it under the terms of the GNU General Public License as published by
 *	the Free Software Foundation, either version 3 of the License, or
 *	any later version.
 *
 *	This program is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 *	GNU General Public License for more details.
 *
 *	You should have received a copy of the GNU General Public License
 *	along with this program. If not, see <http://www.gnu.org/licenses/>
 */

!function(i){function e(e){i(C).html(w.closeText),i(v).css({top:e?-(i(r).innerHeight()/2-e.y):0,left:e?-(i(r).innerWidth()/2-e.x):0,padding:w.padding,"max-width":e?e.w+2*w.padding:""})}function t(e){return e>=0&&e<l.length&&(a=e,s=l[e][0],d(),i(u).html(l[a][1]||""),n(),m=!0,i([r,p,overlay]).toggleClass("visible",!0),i(r).toggleClass("animating",!0),setTimeout(function(){i(v).css({top:0,left:0,"max-width":parseInt(l[a][2]||w.videoWidth)+2*w.padding})},10)),!1}function n(){var e=parseInt(l[a][2]||w.videoWidth),t=parseInt(l[a][3]||w.videoHeight);i(r).css({top:x.scrollTop(),left:x.scrollLeft()}),e+2*w.padding>i(r).innerWidth()&&(e=i(r).innerWidth()-2*w.padding),t=t*e/(l[a][2]||w.videoWidth),t+2*w.padding>i(r).innerHeight()&&(t=i(r).innerHeight()-2*w.padding);var n=100*t/e;i(f).css("padding-bottom",n+"%")}function o(){m&&""==i(g).attr("src")&&(i(g).show(),g.src=s,i(r).toggleClass("animating",!1))}function d(){m=!1,g.src="",i(g).hide()}var l,s,a,r,v,c,f,g,p,b,u,h,C,x=i(window),m=!1,w=defaults={videoWidth:720,videoHeight:405,closeText:"Close",padding:30};i.videobox=function(n,o,d,s){return w=i.extend(defaults,d),i.vbiClose(),e(s),l=n,t(o),!1},i.vbClose=function(){return d(),i([r,p,overlay]).toggleClass("visible",!1),i(r).toggleClass("animating",!1),i(r).css({top:0,left:0}),a>=0&&(a=-1),!1},i.fn.videobox=function(e,t){t=t||function(i){return[i.getAttribute("href"),i.getAttribute("title"),i.getAttribute("data-videowidth"),i.getAttribute("data-videoheight")]};var n=this;return n.unbind("click").click(function(o){for(var d=this,l=0,s=n.slice(),a=i(i(this).find(i(this).attr("data-target"))[0]||this),r=0;r<s.length;r++)s[r]==d&&(l=r),s[r]=t(s[r],r);a.toggleClass("vb_line_fix",!0);var v={x:a.offset().left-x.scrollLeft()+i(a).innerWidth()/2,y:a.offset().top-x.scrollTop()+i(a).innerHeight()/2,w:a.innerWidth()};return a.toggleClass("vb_line_fix",!1),i.videobox(s,l,e,v)})},i(function(){i("body").append(i([overlay=i('<div id="vbOverlay" />').click(i.vbClose)[0],r=i('<div id="vbWrap" />')[0]])),v=i('<div id="vbCenter" />').appendTo(r)[0],c=i('<div id="vbContent" />').appendTo(v).append([f=i('<div id="vbResponsive" />')[0],p=i('<div id="vbBottomContainer" />').on("webkitTransitionEnd transitionend mozTransitionEnd oTransitionEnd",o)[0]])[0],g=i('<iframe id="vbVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(f)[0],b=i('<div id="vbBottom" />').appendTo(p).append([h=i('<a id="vbCloseLink" href="#" ><span id="vbCloseText">'+defaults.closeText+'</span><i class="vb-icon-close"></i></a>').click(i.vbClose)[0],u=i('<span id="vbCaption" />')[0]])[0],C=i(b).find("#vbCloseText")[0]}),x.on("resize",function(){a>=0&&n()}),i("a[rel^='videobox']").videobox({})}(jQuery);

!function(t){function i(){t(m.target).after(c),t(b).css("padding-bottom",100*m.baseHeight/m.baseWidth+"%"),t(c).css("max-width",m.baseWidth),t(m.target).hide(),f=[m.target]}function e(){l>=0&&l<d.length&&(r=d[l][0],t(c).attr("style",d[l][4]),t(c).attr("class",d[l][5]),i(),t(h).html(d[l][1]||""),t(c).toggleClass("visible",!0),v=!0,setTimeout(function(){t(c).css("max-width",parseInt(d[l][2]||m.videoWidth)+2*m.padding);var i=parseInt(d[l][2]||m.videoWidth),e=parseInt(d[l][3]||m.videoHeight);t(b).css("padding-bottom",100*e/i+"%")},10))}function n(){v&&""==t(u).attr("src")&&(t(u).show(),u.src=r,t(c).toggleClass("animating",!1))}function s(){if(!p){p=!0,t(c).detach(),t(c).toggleClass("visible",!1);for(a in f)t(f[a]).show();w&&(w=!1,e())}}function o(){v=!1,u.src="",t(u).hide(),p=!1,t(b).css("padding-bottom",100*m.baseHeight/m.baseWidth+"%"),t(c).css("max-width",m.baseWidth),setTimeout(function(){p||s()},600)}var d,r,l,c,b,u,h,g,v=(t(window),!1),f=[],p=!0,w=!1,m=defaults={videoWidth:720,videoHeight:405,closeText:"Close",padding:30,baseWidth:200,baseHeight:150,target:""};t.vbinline=function(i,e,n,s){return m=t.extend(defaults,n),t.vbClose(),d=i,l=e,w=!0,o(),!1},t.vbiClose=function(){return l>=0&&(l=-1),o(),!1},t.fn.vbinline=function(i,e){e=e||function(t){return[t.getAttribute("href"),t.getAttribute("title"),t.getAttribute("data-videowidth"),t.getAttribute("data-videoheight"),t.getAttribute("data-style"),t.getAttribute("data-class")]};var n=this;return n.unbind("click").click(function(s){for(var a=this,o=0,d=n.slice(),r=t(t(a).find(t(a).attr("data-target"))[0]||a),l=0;l<d.length;l++)d[l]==a&&(o=l),d[l]=e(d[l],l);return i=t.extend(i,{target:a,baseWidth:r.width(),baseHeight:r.height()}),t.vbinline(d,o,i)})},t(function(){c=t('<div id="vbiWrap" />').append([b=t('<div id="vbiResponsive" />').on("webkitTransitionEnd transitionend mozTransitionEnd oTransitionEnd",n)[0],h=t('<span class="vb_video_title"></span>')[0],g=t('<div id="vbiClose"><i class="vb-icon-circle-close-invert"></i></div>').click(t.vbiClose)[0]]).on("webkitTransitionEnd transitionend mozTransitionEnd oTransitionEnd",s)[0],u=t('<iframe id="vbiVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(b)[0]}),t("a[rel^='vbinline']").vbinline({})}(jQuery);

!function(t){function n(t,i){if(t.rm)return void(t.stack.length>0&&t.stack[t.stack.length-1]!=i?t.stack.pop():t.stack.push(i));t.rm="wait";var n="l"==i?t.el.shift():t.el.pop();"l"==i?t.target.append(n):t.target.prepend(n);var r=t.target.children(),a=r["l"==i?0:r.length-1];e(a);var s=t.target.innerHeight();"l"==i?t.target.prepend(a):t.target.append(a),t.cont.toggleClass("animating",!1),t.cont.css("margin-left","l"==i?0:-t.width),t.cont.css("margin-right","l"==i?-t.width:0),setTimeout(function(){"wait"==t.rm&&(t.rm=i,t.cont.toggleClass("animating",!0),t.cont.css({"margin-left":"l"==i?-t.width:0,"margin-right":"l"==i?0:-t.width,height:s}))},20)}function e(i){t(i).find("#vbiWrap").length>0&&t.vbiClose(),t(i).detach()}function r(t){var i=t.target.innerWidth(),n=t.basis+t.target.children().outerWidth(!0)-t.target.children().innerWidth(),e=Math.floor(i/t.basis);if(1>e)e=1;else{var r=2-n/(i/e),s=n/(i/(e+1));r>s&&e++}i/=e,t.width=i,t.count=e,a(t),t.slider.find("i").css("top",t.elTarget?t.target.find(t.elTarget).outerHeight(!0)/2:"")}function a(t){var i=t.target.children();if(i.length<t.count)for(var n=i.length;n<t.count&&t.el.length>0;n++){var r=t.el.shift();t.target.append(r)}else if(i.length>t.count)for(var n=i.length-1;n>=t.count;n--)t.el.unshift(i[n]),e(i[n]);var a=t.target.innerHeight();t.cont.css("height",a)}var s=[];t.vbSlider=function(a,o){var l=t(a).children(),c=t('<div class="vb_slider_outer"></div>').insertAfter(a),d=t('<div class="vb_slider_wrap"></div>').appendTo(c),g={wrap:d,slider:c,prev:t('<div class="vb_slider_prev"><i class="vb-icon-prev"></i></div>').prependTo(c),cont:t('<div class="vb_slider_cont"></div>').append(a).appendTo(d),next:t('<div class="vb_slider_next"><i class="vb-icon-next"></i></div>').appendTo(c),el:[],target:t(a),showPrev:function(){n(g,"r")},showNext:function(){n(g,"l")},basis:t(a).attr("data-width")||l.innerWidth(),skip:function(){if(g.rm&&"wait"!=g.rm){var t=g.rm;g.rm="wait",g.cont.toggleClass("animating",!1),g.cont.css("margin-left",0),g.cont.css("margin-right",0);var r=g.target.children();if(!(r.length<1)){var a;if("l"==t)for(i=0;r.length-i>g.count;i++)a=r[0],g.el.push(a),e(a);else if("r"==t)for(i=0;r.length-i>g.count;i++)a=r[r.length-1-i],g.el.unshift(a),e(a);g.rm=!1,g.stack.length>0&&setTimeout(function(){n(g,g.stack.pop())})}}},rm:!1,stack:[],elTarget:t(a).attr("data-target")};return r(g),g.prev.click(function(){setTimeout(g.showPrev)}),g.next.click(function(){setTimeout(g.showNext)}),g.cont.on("webkitTransitionEnd transitionend mozTransitionEnd oTransitionEnd",function(){setTimeout(g.skip)}),s.push(g),[g]},t.fn.vbSlider=function(i){for(var n=[],e=0;e<this.length;e++)n.concat(t.vbSlider(this[e],i));return n},t(window).on("resize",function(){for(var t=0;t<s.length;t++)r(s[t])}),t(".vb_slider").vbSlider({})}(jQuery);