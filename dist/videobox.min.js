/*!
 *	@author		HitkoDev http://hitko.eu/videobox
 *	@copyright	Copyright (C) 2016 HitkoDev All Rights Reserved.
 *	@license	http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
 *
 *	This program is free software: you can redistribute it and/or modify
 *	it under the terms of the GNU General Public License as published by
 *	the Free Software Foundation, either version 3 of the License, or
 *	any later version.
 *
 *	This program is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 *	GNU General Public License for more details.
 *
 *	You should have received a copy of the GNU General Public License
 *	along with this program. If not, see <http://www.gnu.org/licenses/>
 */
!function(i){function t(t){if(!(0>t||t>=g.length)){l=g[t],e(),i(s).attr("style",l.style),i(s).attr("class",l["class"]),i(a).html(l.title),u=!0;var o={"max-width":(l.origin?l.origin.width:b.initialWidth)+"px"},h={"max-width":(l.width||b.videoWidth)+2*b.padding+"px"},d=s.animate([o,h],b.animation);d.addEventListener("finish",function(){i(s).css(h),n()}),p.push(d);var v={"padding-bottom":100*(l.height||b.videoHeight)/(l.width||b.videoWidth)+"%"};if(l.origin){var c={"padding-bottom":100*l.origin.height/l.origin.width+"%"},d=r.animate([c,v],b.animation);d.addEventListener("finish",function(){i(r).css(v)}),p.push(d)}else i(r).css(v)}}function e(){i(l.origin.target).after(s),i(l.origin.target).hide(),f.push(l.origin.target)}function n(){u&&(i(d).show(),d.src=l.url)}function o(){for(var t=0;t<p.length;t++)p[t].cancel();p=[],u=!1,d.src="",i(d).hide()}var s,r,a,h,d,l,v=i(window),g=[],u=!1,c=!1,p=[],f=[],b={},m={videoWidth:720,videoHeight:405,closeText:"Close",padding:30,animation:{duration:500,iterations:1,delay:0,easing:"ease-in-out"}};i.vbinline=function(e,n,o){return void 0===o&&(o={}),i.extend(b,m,o),i.vbClose(),i.vbiClose(function(){g=e,t(n)}),!1},i.vbiClose=function(t){if(o(),!c)if(i(s).parent().length>0){c=!0;var e=s.animate([{"max-width":(l.width||b.videoWidth)+2*b.padding+"px"},{"max-width":(l.origin?l.origin.width:b.initialWidth)+"px"}],b.animation);if(e.addEventListener("finish",function(){i(s).detach();for(var e=0;e<f.length;e++)i(f[e]).show();f=[],c=!1,t&&t()}),l.origin){r.animate([{"padding-bottom":100*(l.height||b.videoHeight)/(l.width||b.videoWidth)+"%"},{"padding-bottom":100*l.origin.height/l.origin.width+"%"}],b.animation)}}else t&&t();return!1},i.fn.vbinline=function(t,e){void 0===t&&(t={}),void 0===e&&(e=function(i,t){var e={url:i.getAttribute("href")||"",title:i.getAttribute("title")||"",width:parseInt(i.getAttribute("data-videowidth"))||void 0,height:parseInt(i.getAttribute("data-videoheight"))||void 0,style:i.getAttribute("data-style")||void 0,"class":i.getAttribute("data-class")||void 0,index:t};return e});var n=this;return n.unbind("click").click(function(o){for(var s=this,r=0,a=[],h=i(i(this).find(i(this).attr("data-target"))[0]||this),d=0;d<n.length;d++)n[d]==s&&(r=d),a.push(e(n[d],d));return h.toggleClass("vb_line_fix",!0),a[r].origin={x:h.offset().left-v.scrollLeft()+i(h).innerWidth()/2,y:h.offset().top-v.scrollTop()+i(h).innerHeight()/2,width:h.innerWidth(),height:h.innerHeight(),target:s},h.toggleClass("vb_line_fix",!1),i.vbinline(a,r,t)}),!1},i(window).on("load",function(){s=i('<div id="vbiWrap" />').append([r=i('<div id="vbiResponsive" />')[0],a=i('<span class="vb_video_title"></span>')[0],h=i('<div id="vbiClose"><i class="vb-icon-circle-close-invert"></i></div>').click(i.vbiClose)[0]])[0],d=i('<iframe id="vbiVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(r)[0]})}(jQuery),function(i){var t=function(){function t(t,e){this.outer=i('<div class="vb_slider_outer"></div>')[0],this.wrap=i('<div class="vb_slider_wrap"></div>').appendTo(this.outer)[0],this.content=i('<div class="vb_slider_cont"></div>').appendTo(this.wrap)[0],this.prev=i('<div class="vb_slider_prev"><i class="vb-icon-prev"></i></div>').prependTo(this.outer)[0],this.next=i('<div class="vb_slider_next"><i class="vb-icon-next"></i></div>').appendTo(this.outer)[0],this.buttons=i(this.outer).find("i"),this.queue=[],this.timeout=-1,this.moving=!1,this.visible=1,this.detachedElements=[],this.options={move:"single",target:"",singleDuration:500,doubleClickTimeout:200,animation:{duration:500,iterations:1,delay:0,easing:"ease-in-out"}},this.target=t;var n=i(t).children();i(this.outer).insertAfter(t),i(this.content).append(t),this.basis=parseInt(i(t).attr("data-width"))||n.innerWidth(),i.extend(this.options,e),i(this.content).toggleClass(this.options.move,!0);var o=this;i(this.prev).click(function(){o.showPrev()}),i(this.next).click(function(){o.showNext()}),this.setCount()}return t.prototype.showPrev=function(){this.queueMove("r")},t.prototype.showNext=function(){this.queueMove("l")},t.prototype.queueMove=function(i){this.queue.length>0&&this.queue[this.queue.length-1]!=i?this.queue.pop():this.queue.push(i),this.timeout>=0&&clearTimeout(this.timeout);var t=this;this.timeout=setTimeout(function(){t.timeout=-1,!t.moving&&t.queue.length>0&&t.move()},this.options.doubleClickTimeout)},t.prototype.move=function(){this.moving=!0;for(var e=this.queue.pop(),n=1;this.queue.length>0;)n+=this.queue.pop()==e?1:-1;if(0==n)return void(this.moving=!1);0>n&&(e="l"==e?"r":"l",n=0-n);var o=("single"==this.options.move?1:this.visible)*n;o%=this.visible+this.detachedElements.length;for(var s=0;o>s&&this.detachedElements.length>0;s++)"l"==e?i(this.target).append(this.detachedElements.shift()):i(this.target).prepend(this.detachedElements.pop());var r=i(this.target).children(),a="l"==e?r.slice(0,r.length-this.visible):r.slice(this.visible);t.detach(a);var h=i(this.target).innerHeight(),d=100*o/this.visible;"l"==e?i(this.target).prepend(a):i(this.target).append(a);var l=this.options.singleDuration?i.extend({},this.options.animation,{duration:this.options.singleDuration*o}):this.options.animation,v=this,g={"margin-left":("l"==e?0:-d)+"%","margin-right":("l"==e?-d:0)+"%"},u={"margin-left":("l"==e?-d:0)+"%","margin-right":("l"==e?0:-d)+"%"},c=this.content.animate([g,u],l);c.addEventListener("finish",function(){v.skip(e)});var c=this.content.animate([{height:i(this.content).css("height")},{height:h+"px"}],l);c.addEventListener("finish",function(){i(v.content).css("height",h)}),this.buttons.css("top",this.options.target?i(this.target).find(this.options.target).outerHeight(!0)/2:"")},t.detach=function(t){t.find("#vbiWrap").length>0&&i.vbiClose(),t.detach()},t.prototype.skip=function(e){var n=i(this.target).children();if("l"==e){var o=n.slice(0,n.length-this.visible);t.detach(o);for(var s=0;s<o.length;s++)this.detachedElements.push(o[s])}else if("r"==e){var o=n.slice(this.visible);t.detach(o);for(var s=0;s<o.length;s++)this.detachedElements.unshift(o[s])}this.queue.length>0&&this.timeout<0?this.move():this.moving=!1},t.prototype.setCount=function(){var t=this.visible,e=i(this.target).innerWidth(),n=this.basis+i(this.target).children().outerWidth(!0)-i(this.target).children().innerWidth(),o=Math.floor(e/this.basis);if(1>o)o=1;else{var s=2-n/(e/o),r=n/(e/(o+1));s>r&&o++}o!=t&&(this.visible=o,this.setAttached()),i(this.content).css("height",i(this.target).innerHeight()),this.buttons.css("top",this.options.target?i(this.target).find(this.options.target).outerHeight(!0)/2:"")},t.prototype.setAttached=function(){var e=i(this.target).children();if(e.length<this.visible)for(var n=e.length;n<this.visible&&this.detachedElements.length>0;n++)i(this.target).append(this.detachedElements.shift());else if(e.length>this.visible)for(var n=e.length-1;n>=this.visible;n--)this.detachedElements.unshift(e[n]),t.detach(i(e[n]))},t}(),e=[];i.vbSlider=function(n,o){void 0===o&&(o={});for(var s=0;s<e.length;s++)if(e[s].target==n)return i.extend(e[s].options,o),e[s];return new t(n,o)},i.fn.vbSlider=function(t){void 0===t&&(t={});for(var e=[],n=0;n<this.length;n++){var o=this[n],s={},r=i(o).attr("data-target"),a=i(o).attr("data-move");r&&(s.target=r),a&&a.trim()&&(s.move=a.trim()),e.push(i.vbSlider(o,i.extend({},t,s)))}return e},i(window).on("resize",function(){for(var i=0;i<e.length;i++)e[i].setCount()})}(jQuery),function(i){function t(){i(r).html(y.closeText),i(a).css("padding",y.padding),i(y.root).append([v,d]),i(d).css({top:i(y.root).scrollTop(),left:i(y.root).scrollLeft()})}function e(t){if(0>t||t>=w.length)return!1;b=w[t],i(h).html(b.title),n(),x=!0;var e={top:(b.origin?-(i(d).innerHeight()/2-b.origin.y):0)+"px",left:(b.origin?-(i(d).innerWidth()/2-b.origin.x):0)+"px","max-width":b.origin?b.origin.width+2*y.padding+"px":y.initialWidth},s={top:"0px",left:"0px","max-width":(b.width||y.videoWidth)+2*y.padding+"px"};i(a).css(e),i([d,v]).toggleClass("visible",!0),i(d).toggleClass("animating",!0);var r=a.animate([e,s],y.animation);return r.addEventListener("finish",function(){i(a).css(s);var t=g.animate([{"max-height":"0px"},{"max-height":"200px"}],y.animation);t.addEventListener("finish",function(){i(g).toggleClass("visible",!0),o()}),C.push(t)}),C.push(r),!1}function n(){if(b){var t=b.width||y.videoWidth,e=b.height||y.videoHeight;if(i(d).css({top:i(y.root).scrollTop(),left:i(y.root).scrollLeft()}),t+2*y.padding>i(d).innerWidth()){var n=i(d).innerWidth()-2*y.padding;e=e*n/t,t=n}e+2*y.padding>i(d).innerHeight()&&(e=i(d).innerHeight()-2*y.padding);var o=100*e/t;i(l).css("padding-bottom",o+"%")}}function o(){x&&""==i(u).attr("src")&&(i(u).show(),u.src=b.url,i(d).toggleClass("animating",!1))}function s(){for(var t=0;t<C.length;t++)C[t].cancel();C=[],x=!1,u.src="",i(u).hide(),i(d).toggleClass("animating",!1)}var r,a,h,d,l,v,g,u,c,p,f,b,m=i(window),w=[],x=!1,C=[],y={},W={videoWidth:720,videoHeight:405,closeText:"Close",padding:30,initialWidth:"15%",root:i("body")[0],animation:{duration:500,iterations:1,delay:0,easing:"ease-in-out"}};i.videobox=function(n,o,s){if(void 0===s&&(s={}),i.vbiClose(),i.vbClose(),i.extend(y,W,s),t(),n[o].origin&&n[o].origin.target){var r=n[o].origin.target,a=i(i(r).find(i(r).attr("data-target"))[0]||r),h=d.getBoundingClientRect(),l=a[0].getBoundingClientRect();a.toggleClass("vb_line_fix",!0),n[o].origin.x=n[o].origin.x||l.left-h.left+a.innerWidth()/2,n[o].origin.y=n[o].origin.y||l.top-h.top+a.innerHeight()/2,n[o].origin.width=n[o].origin.width||a.innerWidth(),n[o].origin.height=n[o].origin.height||a.innerHeight(),a.toggleClass("vb_line_fix",!1)}return w=n,e(o),!1},i.vbClose=function(){return s(),i([d,g,v]).toggleClass("visible",!1),i(d).css({top:0,left:0}),b&&(b=void 0),!1},i.fn.videobox=function(t,e){void 0===t&&(t={}),void 0===e&&(e=function(i,t){var e={url:i.getAttribute("href")||"",title:i.getAttribute("title")||"",width:parseInt(i.getAttribute("data-videowidth"))||void 0,height:parseInt(i.getAttribute("data-videoheight"))||void 0,index:t};return e});var n=this;return n.unbind("click").click(function(o){for(var s=this,r=0,a=[],h=0;h<n.length;h++)n[h]==s&&(r=h),a.push(e(n[h],h));return a[r].origin={target:s},i.videobox(a,r,t)}),!1},i(window).on("load",function(){i(W.root).append(i([v=i('<div id="vbOverlay" />').click(i.vbClose)[0],d=i('<div id="vbWrap" />')[0]])),a=i('<div id="vbCenter" />').appendTo(d)[0],f=i('<div id="vbContent" />').appendTo(a).append([l=i('<div id="vbResponsive" />')[0],g=i('<div id="vbBottomContainer" />')[0]])[0],u=i('<iframe id="vbVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(l)[0],c=i('<div id="vbBottom" />').appendTo(g).append([p=i('<a id="vbCloseLink" href="#" ><span id="vbCloseText">'+W.closeText+'</span><i class="vb-icon-close"></i></a>').click(i.vbClose)[0],h=i('<strong id="vbCaption" />')[0]])[0],r=i(c).find("#vbCloseText")[0],m.on("resize",function(){x&&b&&n()})})}(jQuery),function(i){i(window).on("load",function(){var t=i(".mdl-layout.mdl-js-layout")[0];t||(t=i("body")[0]),i("a[rel^='videobox']").videobox({root:t}),i("a[rel^='vbinline']").vbinline({}),i(".vb_slider").vbSlider({})})}(jQuery);