/*!
 *	@author		HitkoDev http://hitko.eu/videobox
 *	@copyright	Copyright (C) 2016 HitkoDev All Rights Reserved.
 *	@license	http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL
 *
 *	This program is free software: you can redistribute it and/or modify
 *	it under the terms of the GNU General Public License as published by
 *	the Free Software Foundation, either version 3 of the License, or
 *	any later version.
 *
 *	This program is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 *	GNU General Public License for more details.
 *
 *	You should have received a copy of the GNU General Public License
 *	along with this program. If not, see <http://www.gnu.org/licenses/>
 */
!function(t){function i(i){t(a).html(i.options.closeText),t(i.options.root).append([g,d]),o()}function e(i){b=i,t(l).html(b.title);var e=n();x=!0;var o={top:(b.origin?-(t(d).innerHeight()/2-b.origin.y):0)+"px",left:(b.origin?-(t(d).innerWidth()/2-b.origin.x):0)+"px",maxWidth:b.origin?b.origin.width+"px":b.options.initialWidth},r={top:"0px",left:"0px",maxWidth:b.options.width+"px"};if(t(h).css(o),t([d,g]).toggleClass("visible",!0),t(d).toggleClass("animating",!0),b.origin){var a=100*b.origin.height/b.origin.width||e;a!=e&&w.push(p.animate([{paddingBottom:a+"%"},{paddingBottom:e+"%"}],b.options.animation))}var u=h.animate([o,r],b.options.animation);return t(h).css(r),u.addEventListener("finish",function(){var i=v.animate([{maxHeight:"0px"},{maxHeight:"200px"}],b.options.animation);t(v).toggleClass("visible",!0),i.addEventListener("finish",s),w.push(i)}),w.push(u),!1}function n(){if(b){o();var i=b.options.width,e=b.options.height;if(i+2*b.options.padding>t(d).innerWidth()){var n=t(d).innerWidth()-2*b.options.padding;e=e*n/i,i=n}e+2*b.options.padding>t(d).innerHeight()&&(e=t(d).innerHeight()-2*b.options.padding);var s=100*e/i;return t(p).css("paddingBottom",s+"%"),s}}function o(){var i=t(d).position(),e=d.getBoundingClientRect();t(d).css({top:i.top-e.top,left:i.left-e.left})}function s(){x&&""==t(u).attr("src")&&(t(u).show(),u.src=b.url,t(d).toggleClass("animating",!1))}function r(){for(var i=0;i<w.length;i++)w[i].cancel();w=[],x=!1,u.src="",t(u).hide(),t(d).toggleClass("animating",!1)}var a,h,l,d,p,g,v,u,c,f,b,m=t(window),x=!1,w=[],C={width:720,height:405,closeText:"Close",padding:30,initialWidth:"15%",root:t("body")[0],animation:{duration:500,iterations:1,delay:0,easing:"ease-in-out"}};t.videobox=function(n){t.vbiClose(),t.vbClose(),n.options=t.extend(!0,{},C,n.options),i(n);var o=n.origin.target,s=t(t(o).find(t(o).attr("data-target"))[0]||o),r=d.getBoundingClientRect(),a=s[0].getBoundingClientRect();return s.toggleClass("vb_line_fix",!0),n.origin=t.extend(!0,{},{x:a.left-r.left+s.innerWidth()/2,y:a.top-r.top+s.innerHeight()/2,width:s.innerWidth(),height:s.innerHeight()},n.origin),s.toggleClass("vb_line_fix",!1),e(n),!1},t.vbClose=function(){return r(),t([d,v,g]).toggleClass("visible",!1),t(d).css({top:0,left:0}),b=null,!1},t.fn.videobox=function(i,e){void 0===i&&(i={}),void 0===e&&(e=function(t){var i={url:t.getAttribute("href")||"",title:t.getAttribute("title")||"",options:JSON.parse(t.getAttribute("data-videobox"))||{},origin:{target:t}};return i});var n=this;return n.unbind("click").click(function(n){var o=e(this);return o.options=t.extend(!0,{},i,o.options),t.videobox(o)}),!1},t(window).on("load",function(){t(C.root).append(t([g=t('<div id="vbOverlay" />').click(t.vbClose)[0],d=t('<div id="vbWrap" />')[0]])),h=t('<div id="vbCenter" />').appendTo(d).append([p=t('<div id="vbResponsive" />')[0],v=t('<div id="vbBottomContainer" />')[0]])[0],u=t('<iframe id="vbVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(p)[0],c=t('<div id="vbBottom" />').appendTo(v).append([f=t('<a id="vbCloseLink" href="#" ><span id="vbCloseText">'+C.closeText+'</span><i class="vb-icon-close"></i></a>').click(t.vbClose)[0],l=t('<strong id="vbCaption" />')[0]])[0],a=t(c).find("#vbCloseText")[0],m.on("resize",function(){x&&b&&n()})})}(jQuery),function(t){function i(i){d=i,e(),t(s).attr("style",d.options.style),t(s).attr("class",d.options["class"]),t(a).html(d.title),p=!0;var o={maxWidth:(d.origin?d.origin.width:d.options.initialWidth)+"px"},h={maxWidth:d.options.width+2*d.options.padding+"px"},l=s.animate([o,h],d.options.animation);t(s).css(h),l.addEventListener("finish",n),v.push(l);var g={paddingBottom:100*d.options.height/d.options.width+"%"};if(d.origin){var u={paddingBottom:100*d.origin.height/d.origin.width+"%"},l=r.animate([u,g],d.options.animation);v.push(l)}t(r).css(g)}function e(){t(d.origin.target).after(s),t(d.origin.target).hide(),u.push(d.origin.target)}function n(){p&&(t(l).show(),l.src=d.url)}function o(){for(var i=0;i<v.length;i++)v[i].cancel();v=[],p=!1,l.src="",t(l).hide()}var s,r,a,h,l,d,p=(t(window),!1),g=!1,v=[],u=[],c={width:720,height:405,closeText:"Close",padding:30,animation:{duration:500,iterations:1,delay:0,easing:"ease-in-out"}};t.vbinline=function(e){t.vbClose(),e.options=t.extend(!0,{},c,e.options);var n=e.origin.target,o=t(t(n).find(t(n).attr("data-target"))[0]||n);return o.toggleClass("vb_line_fix",!0),e.origin=t.extend(!0,{},{width:o.innerWidth(),height:o.innerHeight()},e.origin),o.toggleClass("vb_line_fix",!1),t.vbiClose(function(){i(e)}),!1},t.vbiClose=function(i){if(o(),!g)if(t(s).parent().length>0&&d){g=!0;var e=(d.origin?d.origin.width:d.options.initialWidth)+"px",n=s.animate([{maxWidth:d.options.width+2*d.options.padding+"px"},{maxWidth:e}],d.options.animation);if(t(s).css("maxWidth",e),n.addEventListener("finish",function(){t(s).detach();for(var e=0;e<u.length;e++)t(u[e]).show();u=[],g=!1,d=null,"function"==typeof i&&i()}),d.origin){var a=100*d.origin.height/d.origin.width+"%";r.animate([{paddingBottom:100*d.options.height/d.options.width+"%"},{paddingBottom:a}],d.options.animation);t(r).css("paddingBottom",a)}}else{if(t(s).parent().length>0){t(s).detach();for(var h=0;h<u.length;h++)t(u[h]).show();u=[]}d=null,"function"==typeof i&&i()}return!1},t.fn.vbinline=function(i,e){void 0===i&&(i={}),void 0===e&&(e=function(t){var i={url:t.getAttribute("href")||"",title:t.getAttribute("title")||"",options:JSON.parse(t.getAttribute("data-videobox"))||{},origin:{target:t}};return i});var n=this;return n.unbind("click").click(function(n){var o=e(this);return o.options=t.extend(!0,{},i,o.options),t.vbinline(o)}),!1},t(window).on("load",function(){s=t('<div id="vbiWrap" />').append([r=t('<div id="vbiResponsive" />')[0],a=t('<span class="vb_video_title"></span>')[0],h=t('<div id="vbiClose"><i class="vb-icon-circle-close-invert"></i></div>').click(t.vbiClose)[0]])[0],l=t('<iframe id="vbiVideo" frameborder="0" allowfullscreen="true" oallowfullscreen msallowfullscreen webkitallowfullscreen mozallowfullscreen />').css("display","none").appendTo(r)[0]})}(jQuery),function(t){var i=function(){function i(i,e){this.outer=t('<div class="vb_slider_outer"></div>')[0],this.wrap=t('<div class="vb_slider_wrap"></div>').appendTo(this.outer)[0],this.content=t('<div class="vb_slider_cont"></div>').appendTo(this.wrap)[0],this.prev=t('<div class="vb_slider_prev"><i class="vb-icon-prev"></i></div>').prependTo(this.outer)[0],this.next=t('<div class="vb_slider_next"><i class="vb-icon-next"></i></div>').appendTo(this.outer)[0],this.buttons=t(this.outer).find("i"),this.queue=[],this.timeout=-1,this.moving=!1,this.visible=-1,this.detachedElements=[],this.options={moveAll:!1,target:"",singleDuration:500,doubleClickTimeout:200,animation:{duration:500,iterations:1,delay:0,easing:"ease-in-out"}},this.target=i;var n=t(i).children();t(this.outer).insertAfter(i),t(this.content).append(i),this.basis=parseInt(t(i).attr("data-width"))||n.innerWidth(),t.extend(this.options,e),t(this.content).toggleClass("vb-slider__move-all",this.options.moveAll);var o=this;t(this.prev).click(function(){o.showPrev()}),t(this.next).click(function(){o.showNext()}),this.setCount()}return i.prototype.showPrev=function(){this.queueMove("r")},i.prototype.showNext=function(){this.queueMove("l")},i.prototype.setBasis=function(t){t!=this.basis&&(this.basis=t,this.setCount())},i.prototype.isMoving=function(){return this.moving},i.prototype.getTarget=function(){return this.target},i.prototype.queueMove=function(t){this.queue.length>0&&this.queue[this.queue.length-1]!=t?this.queue.pop():this.queue.push(t),this.timeout>=0&&clearTimeout(this.timeout);var i=this;this.timeout=setTimeout(function(){i.timeout=-1,!i.moving&&i.queue.length>0&&i.move()},this.options.doubleClickTimeout)},i.prototype.move=function(){this.moving=!0;for(var e=this.queue.pop(),n=1;this.queue.length>0;)n+=this.queue.pop()==e?1:-1;if(0==n)return void(this.moving=!1);0>n&&(e="l"==e?"r":"l",n=0-n);var o=(this.options.moveAll?this.visible:1)*n;o%=this.visible+this.detachedElements.length;for(var s=0;o>s&&this.detachedElements.length>0;s++)"l"==e?t(this.target).append(this.detachedElements.shift()):t(this.target).prepend(this.detachedElements.pop());var r=t(this.target).children(),a="l"==e?r.slice(0,r.length-this.visible):r.slice(this.visible);i.detach(a);var h=t(this.target).innerHeight(),l=100*o/this.visible;"l"==e?t(this.target).prepend(a):t(this.target).append(a);var d=this.options.singleDuration?t.extend({},this.options.animation,{duration:this.options.singleDuration*o}):this.options.animation,p=this,g={marginLeft:("l"==e?0:-l)+"%",marginRight:("l"==e?-l:0)+"%"},v={marginLeft:("l"==e?-l:0)+"%",marginRight:("l"==e?0:-l)+"%"},u=this.content.animate([g,v],d);u.addEventListener("finish",function(){p.skip(e)});var u=this.content.animate([{height:t(this.content).css("height")},{height:h+"px"}],d);t(p.content).css("height",h),this.buttons.css("top",this.options.target?t(this.target).find(this.options.target).outerHeight(!0)/2:"")},i.detach=function(i){i.find("#vbiWrap").length>0&&t.vbiClose(),i.detach()},i.prototype.skip=function(e){var n=t(this.target).children();if("l"==e){var o=n.slice(0,n.length-this.visible);i.detach(o);for(var s=0;s<o.length;s++)this.detachedElements.push(o[s])}else if("r"==e){var o=n.slice(this.visible);i.detach(o);for(var s=0;s<o.length;s++)this.detachedElements.unshift(o[s])}this.queue.length>0&&this.timeout<0?this.move():this.moving=!1},i.prototype.setCount=function(){var i=this.visible,e=t(this.target).innerWidth(),n=this.basis+t(this.target).children().outerWidth(!0)-t(this.target).children().innerWidth(),o=Math.floor(e/this.basis);if(1>o)o=1;else{var s=2-n/(e/o),r=n/(e/(o+1));s>r&&o++}o!=i&&(this.visible=o,this.setAttached()),t(this.content).css("height",t(this.target).innerHeight()),this.buttons.css("top",this.options.target?t(this.target).find(this.options.target).outerHeight(!0)/2:"")},i.prototype.setAttached=function(){var e=t(this.target).children();if(e.length<this.visible)for(var n=e.length;n<this.visible&&this.detachedElements.length>0;n++)t(this.target).append(this.detachedElements.shift());else if(e.length>this.visible)for(var n=e.length-1;n>=this.visible;n--)this.detachedElements.unshift(e[n]),i.detach(t(e[n]))},i}(),e=[];t.vbSlider=function(n,o){void 0===o&&(o={});for(var s=0;s<e.length;s++)if(e[s].getTarget()==n)return t.extend(e[s].options,o),e[s];return new i(n,o)},t.fn.vbSlider=function(i){void 0===i&&(i={});for(var e=[],n=0;n<this.length;n++){var o=this[n],s={},r=t(o).attr("data-target"),a=t(o).attr("data-move");r&&(s.target=r),a&&a.trim()&&(s.moveAll="all"==a.trim()),e.push(t.vbSlider(o,t.extend({},i,s)))}return e},t(window).on("resize",function(){for(var t=0;t<e.length;t++)e[t].setCount()})}(jQuery),function(t){t(window).on("load",function(){var i=t(".mdl-layout.mdl-js-layout")[0];i||(i=t("body")[0]),t("a[rel^='videobox']").videobox({root:i}),t("a[rel^='vbinline']").vbinline({}),t(".vb_slider").vbSlider({})})}(jQuery);